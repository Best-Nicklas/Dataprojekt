<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="skriv kort bekskrivelse her - ses ved siden artikler">
<title>Prediction • RyouSick</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction">
<meta property="og:description" content="skriv kort bekskrivelse her - ses ved siden artikler">
<meta property="og:image" content="https://best-nicklas.github.io/Dataprojekt/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RyouSick</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/RyouSick.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Prediction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prediction</h1>
            
      
      
      <div class="d-none name"><code>Prediction.Rmd</code></div>
    </div>

    
    
<p>Perhaps the most obvious use after we have created models like GWAS, GWAX and LT-FH would be if we were able to predict whether a new person, with a genotype that has never before been seen, would be ill. There are many ways to predict, and this package in no way contains an exhaustive method of prediction, but we do take some steps to quality control our predictions. The simplest method of predicting would no doubt be doing a linear regression of all of every person’s SNPs on their statuses and then simply matrix multiplying the resulting vector of effect sizes on a new person’s or set of persons’ SNPs, resulting in a single number, their liability score, which could then be converted to a status. The resulting model for predicting would probably not be very good, maybe about as good as randomly guessing. What steps can we take to improve our predictive model? For starters, we are currently using all SNPs no matter how insignificant they are (how high their p-values are in the regression). We can create a vector of p-values to use as thresholds: thresholds &lt;- c(1,0.9,0.75…….)</p>
<p>Now we can get a model for predicting for every single one of these thresholds, each one including a different amount of SNPs. That solves the problem of how many SNPs to include, but there are other issues to solve. What about overfitting? We want to avoid overfitting, but we also want to avoid having to simulate lots of new data to test for overfitting. That’s why we make use of k-fold cross-validation. We split the data into k equal parts, train our predictive model on k-1 parts, and then test the model on the remaining part of the data. Then we repeat for the remaining parts, until we have trained and tested k times. We can then choose the best model for predicting, and if we have done sufficient cross-validation, we can assume that it is not overfitted to the training data. You can in theory choose k to be any number between 1 and n, with n being the number of genotypes. A k = 1 would mean no cross-validating at all, and k = n would mean that the model is trained on n-1 people and tested on 1 person, n times. Our implementation of cross-validation does not allow for k = n, as the scoring system cannot work with too few data points at a time. k = 10 should be sufficient in reducing overfitting in most cases, and as long as the dataset isn’t too small. Because we are working with a small dataset, choose k = 2, but we must keep in mind that there is a high likelihood of overfitting because of this. Now we are ready to get a predictive model, gwas_pred &lt;- prediction_cross_validation(……..) gwas_pred<span class="math inline">\(Results We can now see what would be the best p-value with simple case control status, but what’s stopping us from utilizing our GWAX proxy statuses or our LT-FH posterior mean liabilities? Nothing! We simply change what we are regressing on, but our methodology doesn’t change otherwise. gwax_pred &lt;- prediction_cross_validation(........) gwax_pred\)</span>Results ltfh_pred &lt;- prediction_cross_validation(……..) ltfh_pred$Results We can easily compare and choose the best model for predicting. We can now predict a status for a new person and be comfortable that we have the best model that we can create to do so. new_pred &lt;- prediction_status(new_persons,…..) Though we output statuses, we are actually calculating liabilities, which means we can do even more behind the scenes, like trying to minimize false positives by only assigning someone to be ill if they have a very high liability. When using LT-FH, we can even attempt to guess how many ill and healthy family members a person has, though we should be careful if our model is not already very robust, as the number of possible family combinations also increases rapidly with more siblings.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nicklas Stanislaus, Markus Nielsen, Christian Mains.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
